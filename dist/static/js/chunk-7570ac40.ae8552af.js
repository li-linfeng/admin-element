(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7570ac40"],{"12b5":function(t,e,a){"use strict";a("e85c")},"333d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[a("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},l=[];a("a9e3");Math.easeInOutQuad=function(t,e,a,i){return t/=i/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function s(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function r(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(t,e,a){var i=r(),l=t-i,o=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=o;var r=Math.easeInOutQuad(c,i,l,e);s(r),c<e?n(t):a&&"function"===typeof a&&a()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},per_page:{type:Number,default:10},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.per_page},set:function(t){this.$emit("update:per_page",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,per_page:t}),this.autoScroll&&o(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,per_page:this.pageSize}),this.autoScroll&&o(0,800)}}},u=c,p=(a("e28a"),a("2877")),d=Object(p["a"])(u,i,l,!1,null,"27e53204",null);e["a"]=d.exports},"4bff":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("QueryCol",{attrs:{status:t.statusOptions,cols:t.cols,filter_col:t.listQuery.filter_col,filter_status:t.listQuery.filter_status,filter_val:t.listQuery.filter_val},on:{handleFilter:t.handleFilter}}),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"25px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(e){return t.showDialog("add")}}},[t._v(" 增加 ")]),a("el-table",{staticStyle:{width:"100%","max-width":"1600px"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"需求编号",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.sale_num))])]}}])}),a("el-table-column",{attrs:{label:"项目编号",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.project_id))])]}}])}),a("el-table-column",{attrs:{label:"客户名称",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.customer_type))])]}}])}),a("el-table-column",{attrs:{label:"产品性质",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.product_type))])]}}])}),a("el-table-column",{attrs:{label:"希望货期",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.expect_time))])]}}])}),a("el-table-column",{attrs:{label:"附件",align:"center",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return t._l(i.uploads,(function(e){return a("div",{key:e.name},[a("span",[t._v(t._s(e.name))]),a("el-link",{attrs:{underline:!1,icon:"el-icon-download",href:e.url,type:"primary",download:""}},[t._v("下载")])],1)}))}}])}),a("el-table-column",{attrs:{label:"创建人",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.user.username))])]}}])}),a("el-table-column",{attrs:{label:"应用条件",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.showDialog("detail",i)}}},[t._v(" 查看 ")])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-tag",{attrs:{type:t._f("statusMap")(i.status)}},[t._v(" "+t._s(i.status_cn)+" ")])]}}])}),a("el-table-column",{attrs:{label:"处理人",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.handler.username))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return["open"==i.status||"return"==i.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.publish(i)}}},[t._v(" 发布 ")]):t._e(),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.showDialog("update",i)}}},[t._v(" 修改 ")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,per_page:t.listQuery.per_page},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:per_page":function(e){return t.$set(t.listQuery,"per_page",e)},pagination:t.getList}}),a("el-dialog",{attrs:{title:t.actions[t.dialogAction],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"1200px",height:"800px","margin-left":"50px"},attrs:{model:t.tmp,"label-position":"left","label-width":"140px",rules:t.rules}},[a("el-form-item",{attrs:{label:"需求编号",prop:"sale_num"}},[a("el-input",{staticClass:"small_input",attrs:{disabled:!0},model:{value:t.tmp.sale_num,callback:function(e){t.$set(t.tmp,"sale_num",e)},expression:"tmp.sale_num"}}),"add"==t.dialogAction?a("el-button",{staticStyle:{float:"left","margin-left":"20px"},attrs:{type:"primary"},on:{click:t.getSaleNum}},[t._v("获取编码")]):t._e()],1),a("el-form-item",{attrs:{label:"项目编号",prop:"project_id"}},[a("el-input",{staticClass:"small_input",model:{value:t.tmp.project_id,callback:function(e){t.$set(t.tmp,"project_id",e)},expression:"tmp.project_id"}})],1),a("el-form-item",{attrs:{label:"产品类型",prop:"product_type"}},[a("el-select",{attrs:{disabled:t.editable[t.dialogAction],placeholder:"请选择"},model:{value:t.tmp.product_type,callback:function(e){t.$set(t.tmp,"product_type",e)},expression:"tmp.product_type"}},t._l(t.product_types,(function(t){return a("el-option",{key:t.key,attrs:{label:t.key,value:t.val}})})),1)],1),a("el-form-item",{attrs:{label:"客户名称",prop:"customer_type"}},[a("el-input",{staticClass:"small_input",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.customer_type,callback:function(e){t.$set(t.tmp,"customer_type",e)},expression:"tmp.customer_type"}})],1),a("el-form-item",{attrs:{label:"希望货期",prop:"expect_time"}},[a("el-input",{staticClass:"small_input",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.expect_time,callback:function(e){t.$set(t.tmp,"expect_time",e)},expression:"tmp.expect_time"}})],1),a("label",{staticClass:"el-form-item__label",staticStyle:{width:"700px","font-size":"20px","margin-bottom":"10px",display:"block"}},[t._v("应用条件:")]),a("div",{staticStyle:{height:"400px"}},[a("el-form-item",{staticClass:"small_input",attrs:{label:"设备名称",prop:"device_name"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.device_name,callback:function(e){t.$set(t.tmp,"device_name",e)},expression:"tmp.device_name"}})],1),a("el-form-item",{staticClass:"small_input small_input_right",attrs:{label:"轴1直径及公差",prop:"shaft_one_diameter_tolerance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.shaft_one_diameter_tolerance,callback:function(e){t.$set(t.tmp,"shaft_one_diameter_tolerance",e)},expression:"tmp.shaft_one_diameter_tolerance"}})],1),a("el-form-item",{staticClass:"small_input ",attrs:{label:"驱动类型",prop:"driver_type"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.driver_type,callback:function(e){t.$set(t.tmp,"driver_type",e)},expression:"tmp.driver_type"}})],1),a("el-form-item",{staticClass:"small_input  small_input_right",attrs:{label:"轴2直径及公差",prop:"shaft_two_diameter_tolerance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.shaft_two_diameter_tolerance,callback:function(e){t.$set(t.tmp,"shaft_two_diameter_tolerance",e)},expression:"tmp.shaft_two_diameter_tolerance"}})],1),a("el-form-item",{staticClass:"small_input ",attrs:{label:"驱动功率",prop:"driver_power"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.driver_power,callback:function(e){t.$set(t.tmp,"driver_power",e)},expression:"tmp.driver_power"}})],1),a("el-form-item",{staticClass:"small_input small_input_right",attrs:{label:"轴1配合段长度",prop:"shaft_one_match_distance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.shaft_one_match_distance,callback:function(e){t.$set(t.tmp,"shaft_one_match_distance",e)},expression:"tmp.shaft_one_match_distance"}})],1),a("el-form-item",{staticClass:"small_input",attrs:{label:"使用转速",prop:"rpm"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.rpm,callback:function(e){t.$set(t.tmp,"rpm",e)},expression:"tmp.rpm"}})],1),a("el-form-item",{staticClass:"small_input small_input_right",attrs:{label:"轴2配合段长度",prop:"shaft_two_match_distance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.shaft_two_match_distance,callback:function(e){t.$set(t.tmp,"shaft_two_match_distance",e)},expression:"tmp.shaft_two_match_distance"}})],1),a("el-form-item",{staticClass:"small_input",attrs:{label:"设定扭矩",prop:"torque"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.torque,callback:function(e){t.$set(t.tmp,"torque",e)},expression:"tmp.torque"}})],1),a("el-form-item",{staticClass:"small_input small_input_right",attrs:{label:"轴端面间距",prop:"shaft_space_distance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:t.editable[t.dialogAction]},model:{value:t.tmp.shaft_space_distance,callback:function(e){t.$set(t.tmp,"shaft_space_distance",e)},expression:"tmp.shaft_space_distance"}})],1)],1),a("div",{staticStyle:{width:"400px","margin-bottom":"20px"}},[a("el-form-item",{attrs:{label:"附件"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"uploadFile","before-upload":t.beforeUpload,"file-list":t.fileList}},[a("el-button",{attrs:{size:"small",type:"primary",disabled:t.editable[t.dialogAction]}},[t._v("点击上传")])],1)],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",disabled:t.editable[t.dialogAction]},model:{value:t.tmp.remark,callback:function(e){t.$set(t.tmp,"remark",e)},expression:"tmp.remark"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(" 取消 ")]),a("el-button",{attrs:{type:"primary",disabled:t.editable[t.dialogAction]},on:{click:t.submit}},[t._v(" 确认 ")])],1)],1)],1)},l=[],n=(a("e9c4"),a("a15b"),a("b775"));function s(t){return Object(n["a"])({url:"/api/sale_requests",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/api/sale_requests",method:"post",data:t})}function o(t,e){return Object(n["a"])({url:"/api/sale_requests/".concat(e),method:"put",data:t})}function c(t){return Object(n["a"])({url:"/api/sale_requests/".concat(t),method:"delete"})}function u(){return Object(n["a"])({url:"/api/sale_request_num",method:"get"})}function p(t){return Object(n["a"])({url:"/api/sale_requests/".concat(t,"/publish"),method:"post"})}var d=a("91b6"),m=a("333d"),f=a("622d"),_={name:"SaleRequestIndex",components:{Pagination:m["a"],QueryCol:f["a"]},filters:{statusMap:function(t){var e={open:"info",published:"primary",return:"danger",finish:"success"};return e.status}},data:function(){return{list:null,description:"",total:0,actions:{add:"+新需求",detail:"详情",update:"编辑"},editable:{add:!1,detail:!0,update:!1},dialogFormVisible:!1,dialogAction:"add",statusOptions:[{name:"销售",key:"open"},{name:"处理",key:"published"},{name:"退回",key:"return"},{name:"完成",key:"finish"}],cols:[{key:"sale_num",name:"需求编号"},{key:"customer_type",name:"客户名称"},{key:"product_type",name:"产品性质"}],product_types:[{key:"HNCGD",val:"HNCGD"},{key:"HNCGR",val:"HNCGR"},{key:"HNCTL",val:"HNCTL"},{key:"HNCJW",val:"HNCJW"},{key:"HNCFE",val:"HNCFE"},{key:"HNCHB",val:"HNCHB"},{key:"HNCTE",val:"HNCTE"},{key:"HNCWD",val:"HNCWD"},{key:"HNCCE",val:"HNCCE"},{key:"HNCRB",val:"HNCRB"},{key:"HNCDC",val:"HNCDC"},{key:"HNG",val:"HNG"},{key:"HNS",val:"HNS"}],fileList:[],listQuery:{page:1,per_page:10,filter_col:"",filter_val:"",filter_status:""},tmp:{sale_num:"",project_id:0,product_type:"",customer_type:"",expect_time:"",device_name:"",shaft_one_diameter_tolerance:"",driver_type:"",shaft_two_diameter_tolerance:"",driver_power:"",shaft_one_match_distance:"",rpm:"",shaft_two_match_distance:"",torque:"",shaft_space_distance:"",remark:""},rules:{sale_num:[{required:!0,message:"请填写需求编号",trigger:"change"}],customer_type:[{required:!0,message:"请填写客户名称",trigger:"change"}],product_type:[{required:!0,message:"请填写产品性质",trigger:"change"}]}}},created:function(){this.getList()},methods:{getList:function(){var t=this;return s(this.listQuery).then((function(e){t.list=e.data,t.total=e.total}))},handleFilter:function(t){this.listQuery.page=1,this.listQuery.page=1,this.listQuery.filter_col=t.col?t.col:"",this.listQuery.filter_val=t.val?t.val:"",this.listQuery.filter_status=t.sta?t.sta:"",this.getList()},showDialog:function(t,e){var a=this;this.dialogFormVisible=!0,this.dialogAction=t,this.$nextTick((function(){"add"==t?(a.$refs["dataForm"].resetFields(),a.fileList=[]):(a.tmp=JSON.parse(JSON.stringify(e)),a.fileList=JSON.parse(JSON.stringify(e.uploads)))}))},getSaleNum:function(){var t=this;u().then((function(e){t.tmp.sale_num=e.data.uuid}))},beforeUpload:function(t,e){var a=this,i=new FormData;i.append("file",t),i.append("type","file"),i.append("source_type","sale_request"),Object(d["a"])(i).then((function(t){a.fileList.push(t.data)}))},submit:function(){"add"==this.dialogAction?this.handleData(r):this.handleData(o)},handleData:function(t){for(var e=this,a=[],i=0;i<this.fileList.length;i++)a.push(this.fileList[i].id);this.tmp.upload_ids=a.join(),this.$refs["dataForm"].validate((function(a){a&&t(e.tmp,e.tmp.id).then((function(){e.retrieve()}))}))},publish:function(t){var e=this;p(t.id).then((function(t){e.retrieve()}))},deleteData:function(t){var e=this;c(t.id).then((function(t){e.retrieve()}))},retrieve:function(){var t=this;this.getList().then((function(e){t.dialogFormVisible=!1,t.$notify({title:"Success",message:"操作成功",type:"success",duration:2e3})}))}}},h=_,b=(a("ad64"),a("2877")),g=Object(b["a"])(h,i,l,!1,null,null,null);e["default"]=g.exports},"4c5a":function(t,e,a){},"622d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"filter-container",staticStyle:{display:"inline","margin-bottom":"15px"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"搜索字段",clearable:""},model:{value:t.col,callback:function(e){t.col=e},expression:"col"}},t._l(t.cols,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t.key}})})),1),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"输入搜索内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.val,callback:function(e){t.val=e},expression:"val"}}),a("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"状态",clearable:""},model:{value:t.sta,callback:function(e){t.sta=e},expression:"sta"}},t._l(t.status,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t.key}})})),1),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v(" 搜索 ")])],1)},l=[],n={name:"QueryCol",props:{filter_col:{type:String},filter_val:{type:String},filter_status:{type:String},cols:{type:Array,default:function(){return[]}},status:{type:Array,default:function(){return[]}}},data:function(){return{col:this.filter_col,val:this.filter_val,sta:this.filter_status}},created:function(){},methods:{search:function(){var t={col:this.col,val:this.val,sta:this.sta};this.$emit("handleFilter",t)}}},s=n,r=(a("12b5"),a("2877")),o=Object(r["a"])(s,i,l,!1,null,null,null);e["a"]=o.exports},7893:function(t,e,a){},"91b6":function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var i=a("b775");function l(t){return Object(i["a"])({url:"/api/upload",method:"post",data:t})}},a15b:function(t,e,a){"use strict";var i=a("23e7"),l=a("44ad"),n=a("fc6a"),s=a("a640"),r=[].join,o=l!=Object,c=s("join",",");i({target:"Array",proto:!0,forced:o||!c},{join:function(t){return r.call(n(this),void 0===t?",":t)}})},a9e3:function(t,e,a){"use strict";var i=a("83ab"),l=a("da84"),n=a("94ca"),s=a("6eeb"),r=a("5135"),o=a("c6b6"),c=a("7156"),u=a("c04e"),p=a("d039"),d=a("7c73"),m=a("241c").f,f=a("06cf").f,_=a("9bf2").f,h=a("58a8").trim,b="Number",g=l[b],v=g.prototype,y=o(d(v))==b,k=function(t){var e,a,i,l,n,s,r,o,c=u(t,!1);if("string"==typeof c&&c.length>2)if(c=h(c),e=c.charCodeAt(0),43===e||45===e){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:i=2,l=49;break;case 79:case 111:i=8,l=55;break;default:return+c}for(n=c.slice(2),s=n.length,r=0;r<s;r++)if(o=n.charCodeAt(r),o<48||o>l)return NaN;return parseInt(n,i)}return+c};if(n(b,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var C,w=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof w&&(y?p((function(){v.valueOf.call(a)})):o(a)!=b)?c(new g(k(e)),a,w):k(e)},N=i?m(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;N.length>S;S++)r(g,C=N[S])&&!r(w,C)&&_(w,C,f(g,C));w.prototype=v,v.constructor=w,s(l,b,w)}},ad64:function(t,e,a){"use strict";a("4c5a")},e28a:function(t,e,a){"use strict";a("7893")},e85c:function(t,e,a){},e9c4:function(t,e,a){var i=a("23e7"),l=a("d066"),n=a("d039"),s=l("JSON","stringify"),r=/[\uD800-\uDFFF]/g,o=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,u=function(t,e,a){var i=a.charAt(e-1),l=a.charAt(e+1);return o.test(t)&&!c.test(l)||c.test(t)&&!o.test(i)?"\\u"+t.charCodeAt(0).toString(16):t},p=n((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&i({target:"JSON",stat:!0,forced:p},{stringify:function(t,e,a){var i=s.apply(null,arguments);return"string"==typeof i?i.replace(r,u):i}})}}]);