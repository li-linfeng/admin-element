(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9f36445e"],{"333d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[a("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},l=[];a("a9e3");Math.easeInOutQuad=function(t,e,a,i){return t/=i/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function s(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function r(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(t,e,a){var i=r(),l=t-i,o=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=o;var r=Math.easeInOutQuad(c,i,l,e);s(r),c<e?n(t):a&&"function"===typeof a&&a()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},per_page:{type:Number,default:10},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.per_page},set:function(t){this.$emit("update:per_page",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,per_page:t}),this.autoScroll&&o(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,per_page:this.pageSize}),this.autoScroll&&o(0,800)}}},u=c,p=(a("e28a"),a("2877")),d=Object(p["a"])(u,i,l,!1,null,"27e53204",null);e["a"]=d.exports},"4bff":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilter(e)}},model:{value:t.listQuery.filter_name,callback:function(e){t.$set(t.listQuery,"filter_name",e)},expression:"listQuery.filter_name"}}),a("el-select",{attrs:{clearable:"",placeholder:"状态"},model:{value:t.listQuery.filter_status,callback:function(e){t.$set(t.listQuery,"filter_status",e)},expression:"listQuery.filter_status"}},t._l(t.statusOptions,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v(" 搜索 ")]),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.showAddDialog}},[t._v(" 增加 ")])],1),a("el-table",{staticStyle:{width:"100%","max-width":"1600px"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"需求编号",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.sale_num))])]}}])}),a("el-table-column",{attrs:{label:"客户类型",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.customer_type))])]}}])}),a("el-table-column",{attrs:{label:"产品性质",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.product_type))])]}}])}),a("el-table-column",{attrs:{label:"附件",align:"center",width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return t._l(i.uploads,(function(e){return a("div",{key:e.name},[a("span",[t._v(t._s(e.name))]),a("el-link",{attrs:{underline:!1,icon:"el-icon-download",href:e.url,type:"primary",download:""}},[t._v("下载")])],1)}))}}])}),a("el-table-column",{attrs:{label:"应用条件",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.showDetailDialog(i)}}},[t._v(" 查看 ")])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-tag",{attrs:{type:t._f("statusMap")(i.status)}},[t._v(" "+t._s(i.status_cn)+" ")])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.showDetailDialog(i)}}},[t._v(" 查看详情 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.deleteData(i)}}},[t._v(" 删除 ")]),i.can_dispatch?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.dispatchUser(i)}}},[t._v(" 指定处理人 ")]):t._e()]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,per_page:t.listQuery.per_page},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:per_page":function(e){return t.$set(t.listQuery,"per_page",e)},pagination:t.getList}}),a("el-dialog",{attrs:{title:"add"==t.dialogAction?"增加":"详情",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"1200px",height:"800px","margin-left":"50px"},attrs:{model:t.tmp,"label-position":"left","label-width":"140px"}},[a("el-form-item",{attrs:{label:"需求编号",prop:"sale_num"}},[a("el-input",{staticClass:"small_input",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.sale_num,callback:function(e){t.$set(t.tmp,"sale_num",e)},expression:"tmp.sale_num"}}),"add"==t.dialogAction?a("el-button",{staticStyle:{float:"left","margin-left":"20px"},attrs:{type:"primary"},on:{click:t.getSaleNum}},[t._v("获取编码")]):t._e()],1),a("el-form-item",{attrs:{label:"产品类型",prop:"product_type"}},[a("el-select",{attrs:{disabled:"add"!=t.dialogAction,placeholder:"请选择"},model:{value:t.tmp.product_type,callback:function(e){t.$set(t.tmp,"product_type",e)},expression:"tmp.product_type"}},t._l(t.product_types,(function(t){return a("el-option",{key:t.key,attrs:{label:t.key,value:t.val}})})),1)],1),a("el-form-item",{attrs:{label:"客户性质",prop:"customer_type"}},[a("el-select",{attrs:{disabled:"add"!=t.dialogAction,placeholder:"请选择"},model:{value:t.tmp.customer_type,callback:function(e){t.$set(t.tmp,"customer_type",e)},expression:"tmp.customer_type"}},t._l(t.custom_types,(function(t){return a("el-option",{key:t.key,attrs:{label:t.key,value:t.val}})})),1)],1),a("label",{staticClass:"el-form-item__label",staticStyle:{width:"700px","font-size":"20px","margin-bottom":"10px",display:"block"}},[t._v("应用条件:")]),a("div",{staticStyle:{height:"400px"}},[a("el-form-item",{staticClass:"small_input",attrs:{label:"设备名称",prop:"device_name"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.device_name,callback:function(e){t.$set(t.tmp,"device_name",e)},expression:"tmp.device_name"}})],1),a("el-form-item",{staticClass:"small_input small_input_right",attrs:{label:"轴1直径及公差",prop:"shaft_one_diameter_tolerance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.shaft_one_diameter_tolerance,callback:function(e){t.$set(t.tmp,"shaft_one_diameter_tolerance",e)},expression:"tmp.shaft_one_diameter_tolerance"}})],1),a("el-form-item",{staticClass:"small_input ",attrs:{label:"驱动类型",prop:"driver_type"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.driver_type,callback:function(e){t.$set(t.tmp,"driver_type",e)},expression:"tmp.driver_type"}})],1),a("el-form-item",{staticClass:"small_input  small_input_right",attrs:{label:"轴2直径及公差",prop:"shaft_two_diameter_tolerance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.shaft_two_diameter_tolerance,callback:function(e){t.$set(t.tmp,"shaft_two_diameter_tolerance",e)},expression:"tmp.shaft_two_diameter_tolerance"}})],1),a("el-form-item",{staticClass:"small_input ",attrs:{label:"驱动功率",prop:"driver_power"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.driver_power,callback:function(e){t.$set(t.tmp,"driver_power",e)},expression:"tmp.driver_power"}})],1),a("el-form-item",{staticClass:"small_input small_input_right",attrs:{label:"轴1配合段长度",prop:"shaft_one_match_distance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.shaft_one_match_distance,callback:function(e){t.$set(t.tmp,"shaft_one_match_distance",e)},expression:"tmp.shaft_one_match_distance"}})],1),a("el-form-item",{staticClass:"small_input",attrs:{label:"使用转速",prop:"rpm"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.rpm,callback:function(e){t.$set(t.tmp,"rpm",e)},expression:"tmp.rpm"}})],1),a("el-form-item",{staticClass:"small_input small_input_right",attrs:{label:"轴2配合段长度",prop:"shaft_two_match_distance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.shaft_two_match_distance,callback:function(e){t.$set(t.tmp,"shaft_two_match_distance",e)},expression:"tmp.shaft_two_match_distance"}})],1),a("el-form-item",{staticClass:"small_input",attrs:{label:"设定扭矩",prop:"torque"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.torque,callback:function(e){t.$set(t.tmp,"torque",e)},expression:"tmp.torque"}})],1),a("el-form-item",{staticClass:"small_input small_input_right",attrs:{label:"轴端面间距",prop:"shaft_space_distance"}},[a("el-input",{staticClass:"input_val",attrs:{disabled:"detail"==t.dialogAction},model:{value:t.tmp.shaft_space_distance,callback:function(e){t.$set(t.tmp,"shaft_space_distance",e)},expression:"tmp.shaft_space_distance"}})],1)],1),a("div",{staticStyle:{width:"400px","margin-bottom":"20px"}},[a("el-form-item",{attrs:{label:"附件"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"uploadFile","before-upload":t.beforeUpload,"file-list":t.fileList}},[a("el-button",{attrs:{size:"small",type:"primary",disabled:"detail"==t.dialogAction}},[t._v("点击上传")])],1)],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",disabled:"detail"==t.dialogAction},model:{value:t.tmp.remark,callback:function(e){t.$set(t.tmp,"remark",e)},expression:"tmp.remark"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(" 取消 ")]),a("el-button",{attrs:{type:"primary",disabled:"detail"==t.dialogAction},on:{click:t.submit}},[t._v(" 确认 ")])],1)],1)],1)},l=[],n=(a("a15b"),a("b775"));function s(t){return Object(n["a"])({url:"/api/sale_requests",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/api/sale_requests",method:"post",data:t})}function o(t,e){return Object(n["a"])({url:"/api/sale_requests/".concat(t),method:"put",data:e})}function c(t){return Object(n["a"])({url:"/api/sale_requests/".concat(t),method:"delete"})}function u(){return Object(n["a"])({url:"/api/sale_request_num",method:"get"})}function p(t,e){return Object(n["a"])({url:"/api/sale_requests/".concat(t,"/handle_user"),method:"post",data:e})}var d=a("91b6"),m=a("333d"),f={name:"SaleRequestIndex",components:{Pagination:m["a"]},filters:{statusMap:function(t){var e={open:"success",handle:"primary",finish:"info",cancel:"error"};return e.status}},data:function(){return{list:null,description:"",total:0,dialogFormVisible:!1,dialogAction:"add",statusOptions:[{label:"新建",value:"open"},{label:"处理中",value:"handle"},{label:"完成",value:"finish"},{label:"取消",value:"cancel"}],product_types:[{key:"TL",val:"TL"},{key:"GRID",val:"GRID"},{key:"GEAR",val:"GEAR"},{key:"ELAS",val:"ELAS"}],custom_types:[{key:"E",val:"E"},{key:"G",val:"G"},{key:"C",val:"C"},{key:"B",val:"B"}],fileList:[],listQuery:{page:1,per_page:10,filter_name:"",filter_status:""},tmp:{sale_num:"",description:""}}},created:function(){this.getList()},methods:{getList:function(){var t=this;return s(this.listQuery).then((function(e){t.list=e.data,t.total=e.total,t.tmp={sale_num:""}}))},handleFilter:function(){this.listQuery.page=1,this.getList()},showAddDialog:function(){this.dialogFormVisible=!0,this.dialogAction="add"},showDetailDialog:function(t){this.dialogFormVisible=!0,this.dialogAction="detail",this.tmp=t,this.fileList=t.uploads},getSaleNum:function(){var t=this;u().then((function(e){t.tmp.sale_num=e.data.uuid}))},dispatchUser:function(t){var e=this,a={user_id:0};p(t.id,a).then((function(){e.retrieve()}))},beforeUpload:function(t,e){var a=this,i=new FormData;i.append("file",t),i.append("type","file"),i.append("source_type","sale_request"),Object(d["a"])(i).then((function(t){a.fileList.push(t.data)}))},submit:function(){"add"==this.dialogAction?this.addData():this.editData()},addData:function(){for(var t=this,e=[],a=0;a<this.fileList.length;a++)e.push(this.fileList[a].id);this.tmp.upload_ids=e.join(),r(this.tmp).then((function(){t.retrieve()}))},editData:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&o(t.tmp.id,t.tmp).then((function(){t.retrieve()}))}))},deleteData:function(t){var e=this;c(t.id).then((function(t){e.retrieve()}))},retrieve:function(){var t=this;this.getList().then((function(e){t.dialogFormVisible=!1,t.$notify({title:"Success",message:"操作成功",type:"success",duration:2e3})}))}}},_=f,h=(a("b05d"),a("2877")),b=Object(h["a"])(_,i,l,!1,null,null,null);e["default"]=b.exports},7893:function(t,e,a){},"91b6":function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var i=a("b775");function l(t){return Object(i["a"])({url:"/api/upload",method:"post",data:t})}},"9a5d":function(t,e,a){},a15b:function(t,e,a){"use strict";var i=a("23e7"),l=a("44ad"),n=a("fc6a"),s=a("a640"),r=[].join,o=l!=Object,c=s("join",",");i({target:"Array",proto:!0,forced:o||!c},{join:function(t){return r.call(n(this),void 0===t?",":t)}})},a9e3:function(t,e,a){"use strict";var i=a("83ab"),l=a("da84"),n=a("94ca"),s=a("6eeb"),r=a("5135"),o=a("c6b6"),c=a("7156"),u=a("c04e"),p=a("d039"),d=a("7c73"),m=a("241c").f,f=a("06cf").f,_=a("9bf2").f,h=a("58a8").trim,b="Number",g=l[b],v=g.prototype,y=o(d(v))==b,k=function(t){var e,a,i,l,n,s,r,o,c=u(t,!1);if("string"==typeof c&&c.length>2)if(c=h(c),e=c.charCodeAt(0),43===e||45===e){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:i=2,l=49;break;case 79:case 111:i=8,l=55;break;default:return+c}for(n=c.slice(2),s=n.length,r=0;r<s;r++)if(o=n.charCodeAt(r),o<48||o>l)return NaN;return parseInt(n,i)}return+c};if(n(b,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var w,A=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof A&&(y?p((function(){v.valueOf.call(a)})):o(a)!=b)?c(new g(k(e)),a,A):k(e)},C=i?m(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;C.length>S;S++)r(g,w=C[S])&&!r(A,w)&&_(A,w,f(g,w));A.prototype=v,v.constructor=A,s(l,b,A)}},b05d:function(t,e,a){"use strict";a("9a5d")},e28a:function(t,e,a){"use strict";a("7893")}}]);